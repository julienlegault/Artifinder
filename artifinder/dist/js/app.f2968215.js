(function(e){function t(t){for(var r,s,o=t[0],c=t[1],l=t[2],d=0,m=[];d<o.length;d++)s=o[d],a[s]&&m.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),a=n("ce5b"),i=n.n(a),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("v-app",{attrs:{id:"inspire",dark:""}},[n("v-toolbar",{attrs:{app:"",fixed:"","clipped-left":""}},[n("v-toolbar-title",[e._v("Artifinder")]),n("v-spacer"),n("Login"),n("v-toolbar-items",[n("v-menu",{attrs:{"offset-y":""}},[n("v-btn",{attrs:{slot:"activator",flat:""},slot:"activator"},[e._v(e._s(e.name))]),n("v-list",[n("v-list-tile",{on:{click:e.logout}},[n("v-list-tile-title",[e._v("logout")])],1)],1)],1)],1)],1),n("v-content",[n("router-view")],1),n("v-footer",{attrs:{dark:"",height:"auto"}},[n("v-layout",{attrs:{"justify-center":"",row:"",wrap:""}},[n("v-btn",{staticClass:"white--text",attrs:{icon:"",href:"https://discord.gg/7arjbp4",target:"_blank"}},[n("font-awesome-icon",{attrs:{icon:["fab","discord"],size:"2x"}})],1),n("v-btn",{staticClass:"white--text",attrs:{icon:"",href:"https://github.com/nminchow/Artifinder",target:"_blank"}},[n("font-awesome-icon",{attrs:{icon:["fab","github"],size:"2x"}})],1)],1)],1)],1)],1)},o=[],c=(n("7f7f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{"max-width":"290",value:e.pendingLogin},on:{input:e.setPending}},[n("v-card",[n("v-card-text",[e._v("\n       Please select a username. Your Steam ID is recomended so other users know who you are in-game.\n      ")]),n("v-form",[n("v-container",[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Username / Steam ID","data-vv-name":"name","error-messages":e.errors.collect("name")},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1)],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary"},on:{click:e.login}},[e._v("\n          Set\n        ")])],1)],1)],1)}),l=[],u=(n("0d6d"),n("d4ec")),d=n("59ca"),m=n.n(d),v=(n("e71f"),n("ea7b"),n("2f62"));r["default"].use(v["a"]);var f={name:null,userId:null,pendingLogin:!1,creatingGame:!1,currentGame:null},p=new v["a"].Store({state:{user:f,previewGame:null},mutations:{login:function(e,t){e.user.name=t.name,e.user.userId=t.userId,e.user.currentGame=t.currentGame,e.user.pendingLogin=!1},logout:function(e){e.user.name=null,e.user.userId=null,e.user.currentGame=null},togglePending:function(e){return e.user.pendingLogin=!0},setPending:function(e,t){return e.user.pendingLogin=t.pending},setCreating:function(e,t){return e.user.creatingGame=t.creatingGame},setGame:function(e,t){e.user.currentGame=t.currentGame},setPreview:function(e,t){return e.previewGame=t.previewGame}},actions:{}}),g=function e(){Object(u["a"])(this,e),m.a.initializeApp({apiKey:"AIzaSyBEkwobHbPAQ2Yya6VNY1BNsLFg1wR0g_w",authDomain:"artifinder-191f7.firebaseapp.com",projectId:"artifinder-191f7"}),this.db=m.a.firestore(),this.db.settings({timestampsInSnapshots:!0}),this.instance=m.a},h=new g;Object.freeze(h);var b=h,y=function(){this.$validator.validateAll().then(function(e){e&&b.instance.auth().signInAnonymously().catch(function(e){e.code,e.message})})},w=function(e){var t=b.db.collection("userData");if(this.pendingLogin){var n={name:this.name,currentGame:null};return t.doc(e.uid).set(n)}return Promise.resolve()},_=function(e){this.$store.commit({type:"setPending",pending:1==e})},G={data:function(){return{name:""}},mounted:function(){var e=this;b.instance.auth().onAuthStateChanged(function(t){t?e.createIfNeeded(t).then(function(){b.db.collection("userData").doc(t.uid).onSnapshot(function(n){var r=n.data();e.$store.commit({type:"login",name:r.name,currentGame:r.currentGame,userId:t.uid})})}):e.$store.commit("logout")})},methods:{login:y,setPending:_,createIfNeeded:w},computed:{loggedIn:function(){return null!=this.$store.state.user.name},pendingLogin:function(){return this.$store.state.user.pendingLogin}}},k=G,x=n("2877"),I=Object(x["a"])(k,c,l,!1,null,null,null);I.options.__file="login.vue";var L=I.exports,P={components:{Login:L},computed:{name:function(){return this.$store.state.user.name}},methods:{logout:function(){b.instance.auth().signOut()}}},$=P,C=Object(x["a"])($,s,o,!1,null,null,null);C.options.__file="App.vue";var j=C.exports,O=n("8c4f"),T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"game-list"},[n("v-container",{attrs:{fluid:"","grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:"",sm6:""}},[n("v-card",[n("v-toolbar",{attrs:{color:"secondary"}},[n("v-toolbar-title",{staticClass:"white--text"},[e._v("Tournaments")]),n("v-spacer"),n("v-btn",{attrs:{color:"success"},on:{click:e.addItem}},[e._v("Create")]),n("createGame")],1),n("v-card-actions",{staticClass:"pa-0"},[n("v-form",[n("v-container",{staticClass:"pa-10 pb-0"},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-select",{attrs:{items:e.filters,label:"Type"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)],1)],1)],1),n("v-list",{attrs:{dense:"","two-line":""}},e._l(e.games,function(t,r){return n("span",{key:t.created.seconds+t.created.nanoseconds/1e7},[n("v-divider"),n("v-list-tile",{attrs:{ripple:""},on:{click:function(n){e.preview(t.id)}}},[n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(t.description))]),n("v-list-tile-sub-title",[e._v("\n                    "+e._s(t.currentPlayers)+"/"+e._s(t.playerLimit)+"\n                    - "+e._s(t.type)+"\n                  ")])],1)],1)],1)}))],1)],1),n("v-flex",{attrs:{xs12:"",sm6:""}},[n("v-card",[n("game",{attrs:{gameId:e.previewGame||e.gameId}})],1)],1)],1)],1)],1)},S=[],z=n("be94"),A=(n("ac6a"),n("bee2")),E=function(){function e(){Object(u["a"])(this,e)}return Object(A["a"])(e,null,[{key:"addUserToGame",value:function(e,t){var n=this;return t.collection("members").doc(e.state.user.userId).set({name:e.state.user.name}).then(function(){b.db.runTransaction(function(e){return e.get(t).then(function(n){if(n.exists){var r=n.data().currentPlayers+1;e.update(t,{currentPlayers:r})}})}).catch(function(e){})}).then(function(){return null==e.state.user.currentGame?Promise.resolve():n.removeFromGame(e.state.user.userId,e.state.user.currentGame)}).then(function(){return b.db.collection("userData").doc(e.state.user.userId).update({currentGame:t.id})}).then(function(){return e.commit({type:"setGame",currentGame:t.id})}).then(function(){return e.commit({type:"setPreview",currentGame:null})}).catch(function(e){console.error("Error adding document: ",e)})}},{key:"removeFromGame",value:function(e,t){var n=this,r=b.db.collection("games").doc(t);return b.db.runTransaction(function(e){return e.get(r).then(function(t){if(t.exists){var n=t.data().currentPlayers-1;e.update(r,{currentPlayers:n})}})}).catch(function(e){console.log("error decrementing")}).then(function(){return n.removeGameMember(e,t)})}},{key:"removeGameMember",value:function(e,t){return b.db.collection("games").doc(t).collection("members").doc(e).delete().catch(function(e){console.log("error removing")})}},{key:"removeUserGameRef",value:function(e){return b.db.collection("userData").doc(e).update({currentGame:null}).catch(function(e){console.log("error remoing ref")})}}]),e}(),N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"game-list"},[n("v-toolbar",{attrs:{color:"secondary"}},[e.inGame?n("v-toolbar-title",{staticClass:"white--text"},[e._v("Current Tournament")]):n("v-toolbar-title",{staticClass:"white--text"},[e._v("Tournament Preview")]),n("v-spacer"),e.showBackLink?n("v-btn",{on:{click:e.backToCurrent}},[e._v("Back")]):e._e()],1),null!=e.game?n("div",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("div",{staticClass:"headline"},[e._v(e._s(e.game.description))]),n("div",{staticClass:"grey--text"},[e._v("\n            "+e._s(e.game.currentPlayers)+"/"+e._s(e.game.playerLimit)+"\n            - "+e._s(e.game.type)+"\n          ")])])]),n("v-card-actions",[e.joinable?n("v-btn",{attrs:{color:"success"},on:{click:e.join}},[e._v("Join")]):e._e(),e.inGame&&null!=e.game.link&&!e.copyTooltip?n("v-btn",{attrs:{color:"accent"},on:{click:e.copyLink}},[e._v("Copy Game Link")]):e._e(),e.copyTooltip?n("v-btn",{attrs:{color:"primary"}},[e._v(" Copied to clipboard! ")]):e._e(),n("v-spacer"),e.selfIsOwner?n("v-btn",{attrs:{fab:"",small:"",color:"red",flat:""},on:{click:e.deleteGame}},[n("v-icon",[e._v("delete_forever")])],1):e._e()],1),n("v-list",{attrs:{dense:""}},[n("v-subheader",[e._v("\n          Players\n        ")]),n("v-divider"),e._l(e.players,function(t){return n("v-list-tile",{key:t.id},[n("v-list-tile-avatar",[e.userIsOwner(t)?n("v-icon",[e._v("star")]):n("v-icon",[e._v("person")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v(" "+e._s(t.name))])],1),e.selfIsOwner||e.isSelf(t)?n("v-list-tile-action",[n("v-btn",{attrs:{icon:"",ripple:""},on:{click:function(n){e.removePlayer(t)}}},[n("v-icon",{attrs:{color:"grey lighten-1"}},[e._v("cancel")])],1)],1):e._e()],1)})],2),n("v-spacer")],1):n("div",[n("v-card-title",[n("div",[n("span",{staticClass:"grey--text"},[e._v("select or create a tournament")])])])],1)],1)},D=[],M=(n("5df3"),n("b54a"),n("f904")),U=n.n(M),q=function(){if(this.loggedIn)return E.addUserToGame(this.$store,b.db.collection("games").doc(this.gameId));this.$store.commit("togglePending")},B=function(){var e=this;this.copyTooltip=!0,U()(this.game.link),setTimeout(function(){e.copyTooltip=!1},2e3)},F=function(){this.$store.commit({type:"setPreview",previewGame:null})},J=function(){var e=this.gameId,t=this,n=[];b.db.collection("games").doc(e).collection("members").get().then(function(t){t.forEach(function(t){n.push(E.removeUserGameRef(t.id).then(function(){E.removeGameMember(t.id,e)}))})}).then(function(){Promise.all(n).then(function(){b.db.collection("games").doc(e).delete().then(function(){t.game=null})})})},R=function(e){return e.id==this.game.owner},Y=function(e){return e.id==this.$store.state.user.userId},H=function(e){E.removeFromGame(e.id,this.game.id).then(function(){E.removeUserGameRef(e.id)})},V={props:["gameId"],data:function(){return{game:null,players:[],gameListener:null,playerListener:null,copyTooltip:!1}},methods:{join:q,backToCurrent:F,copyLink:B,deleteGame:J,userIsOwner:R,isSelf:Y,removePlayer:H},computed:{joinable:function(){return null!=this.game&&(this.$store.state.user.currentGame!=this.gameId&&this.game.currentPlayers<this.game.playerLimit)},showBackLink:function(){return null!=this.$store.state.user.currentGame&&this.$store.state.user.currentGame!=this.gameId},inGame:function(){var e=this;return null!=this.game&&(!this.joinable&&this.players.some(function(t){return t.id==e.$store.state.user.userId}))},loggedIn:function(){return null!=this.$store.state.user.name},selfIsOwner:function(){return null!=this.game&&this.$store.state.user.userId==this.game.owner}},watch:{gameId:function(e,t){var n=this,r=this;null!=t&&(this.gameListener(),this.playerListener(),r.players=[]),null!=e?(this.gameListener=b.db.collection("games").doc(e).onSnapshot(function(e){e.exists&&(n.game=Object(z["a"])({},e.data(),{id:e.id}))}),this.playerListener=b.db.collection("games").doc(e).collection("members").onSnapshot(function(e){r.players=[],e.forEach(function(e){r.players.push(Object(z["a"])({},e.data(),{id:e.id}))})})):this.game=null}}},K=V,Q=Object(x["a"])(K,N,D,!1,null,null,null);Q.options.__file="game.vue";var W=Q.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{"max-width":"290",value:e.creatingGame},on:{input:e.setCreating}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("div",{staticClass:"headline"},[e._v("Create Tournament")])])]),n("v-card-actions",{staticClass:"pa-3"},[n("v-form",[n("v-container",[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|min:5",expression:"'required|min:5'"}],attrs:{label:"Name","data-vv-name":"name","error-messages":e.errors.collect("name")},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|url",expression:"'required|url'"}],attrs:{label:"Join Link","data-vv-name":"link","error-messages":e.errors.collect("link")},model:{value:e.link,callback:function(t){e.link=t},expression:"link"}}),n("v-select",{attrs:{items:e.types,label:"Type"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}),n("v-select",{attrs:{items:e.sizes,label:"Size"},model:{value:e.size,callback:function(t){e.size=t},expression:"size"}})],1)],1)],1)],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"success"},on:{click:e.createGame}},[e._v("\n          Create\n        ")])],1)],1)],1)},Z=[],ee=function(e){this.$store.commit({type:"setCreating",creatingGame:1==e})},te=function(){var e=this;this.$validator.validateAll().then(function(t){t&&b.db.collection("games").add({description:e.name,playerLimit:e.size,currentPlayers:0,created:b.instance.firestore.FieldValue.serverTimestamp(),owner:e.$store.state.user.userId,link:e.link,type:e.type}).then(function(t){return E.addUserToGame(e.$store,t)}).then(function(){e.setCreating(!1)}).catch(function(){})})},ne={data:function(){return{name:"",link:"",sizes:[4,8,16,32,64],size:4,types:["draft","constructed"],type:"draft"}},methods:{setCreating:ee,createGame:te},computed:{creatingGame:function(){return this.$store.state.user.creatingGame}}},re=ne,ae=Object(x["a"])(re,X,Z,!1,null,null,null);ae.options.__file="createGame.vue";var ie=ae.exports,se=function(){this.loggedIn?this.$store.commit({type:"setCreating",creatingGame:!0}):this.$store.commit("togglePending")},oe=function(e){this.$store.commit({type:"setPreview",previewGame:e}),this.$vuetify.breakpoint.xs&&window.scrollTo(0,document.body.scrollHeight)},ce=function(e){var t=this;null!=this.gamesListener&&this.gamesListener();var n=b.db.collection("games").orderBy("created","desc").limit(10);"all"!=e&&(n=n.where("type","==",e)),this.gamesListener=n.onSnapshot(function(e){t.games=[],e.forEach(function(e){e.metadata.hasPendingWrites||t.games.push(Object(z["a"])({},e.data(),{id:e.id}))})})},le={name:"home",data:function(){return{games:[],db:null,gamesListener:null,filters:["all","draft","constructed"],filter:"all"}},components:{game:W,createGame:ie},methods:{addItem:se,preview:oe,setListener:ce},watch:{filter:function(e,t){this.setListener(e)}},mounted:function(){this.setListener(this.filter)},computed:{loggedIn:function(){return null!=this.$store.state.user.name},gameId:function(){return this.$store.state.user.currentGame},previewGame:function(){return this.$store.state.previewGame}}},ue=le,de=Object(x["a"])(ue,T,S,!1,null,null,null);de.options.__file="gameList.vue";var me=de.exports;r["default"].use(O["a"]);var ve=new O["a"]({routes:[{path:"/",name:"gameList",component:me}]}),fe=n("7bb1"),pe=n("ecee"),ge=n("f2d1"),he=n("ad3d");n("bf40");pe["c"].add(ge["a"],ge["b"]),r["default"].component("font-awesome-icon",he["a"]),r["default"].config.productionTip=!1,r["default"].use(fe["a"]),r["default"].use(i.a,{theme:{primary:"#a59465",secondary:"#56077a",accent:"#3e918b",error:"#e57937",warning:"#ffeb3b",info:"#2196f3",success:"#a59465"}}),new r["default"]({router:ve,store:p,render:function(e){return e(j)}}).$mount("#app")}});
//# sourceMappingURL=app.f2968215.js.map